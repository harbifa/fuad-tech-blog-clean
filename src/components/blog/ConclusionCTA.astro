---
// كتلة ختامية مع زر Call-to-Action. تدعم الآن لون صندوق "night" وزر بلون مختلف.
// لا <style> ولا @apply – Tailwind فقط.

export interface Props {
  title: string;
  buttonText: string;
  href: string;
  icon?: string;

  /** لون الصندوق */
  color?:
    | 'yellow'
    | 'blue'
    | 'green'
    | 'purple'
    | 'brown'
    | 'cyan'
    | 'red'
    | 'slate'
    | 'night';                        // ← جديد

  /** لون الزر (افتراضي = color إذا توفّر في القائمة) */
  buttonColor?:
    | 'yellow'
    | 'blue'
    | 'green'
    | 'purple'
    | 'brown'
    | 'cyan'
    | 'red'
    | 'slate';
}

const {
  title,
  buttonText,
  href,
  icon,
  color = 'blue',
  buttonColor,
} = Astro.props;

const hasIcon = Boolean(icon);

// —— ألوان الصندوق ——————————————————————————
const boxColors = {
  yellow:
    'border-yellow-400 bg-yellow-50 text-yellow-800  dark:border-yellow-500 dark:bg-yellow-900/20 dark:text-yellow-200',
  blue:
    'border-blue-400  bg-blue-50  text-blue-800   dark:border-blue-500  dark:bg-blue-900/25  dark:text-blue-200',
  green:
    'border-green-400 bg-green-50 text-green-800  dark:border-green-500 dark:bg-green-900/25 dark:text-green-200',
  purple:
    'border-purple-400 bg-purple-50 text-purple-800 dark:border-purple-500 dark:bg-purple-900/25 dark:text-purple-200',
  brown:
    'border-amber-600 bg-amber-50 text-amber-800 dark:border-amber-600 dark:bg-amber-900/25 dark:text-amber-200',
  cyan:
    'border-cyan-400  bg-cyan-50  text-cyan-800   dark:border-cyan-500  dark:bg-cyan-900/25  dark:text-cyan-200',
  red:
    'border-red-400   bg-red-50   text-red-800    dark:border-red-500   dark:bg-red-900/25   dark:text-red-200',
  slate:
    'border-slate-400 bg-slate-50 text-slate-800  dark:border-slate-500 dark:bg-slate-800/40 dark:text-slate-200',

  //  ➜ جديد: خلفية داكنة ثابتة في الوضعَين
  night:
    'border-transparent bg-slate-900 text-white dark:bg-slate-900',
};

// —— ألوان الأزرار ——————————————————————————
const btnColors = {
  yellow:
    'bg-yellow-500 hover:bg-yellow-600 focus-visible:ring-yellow-600 dark:bg-yellow-600 dark:hover:bg-yellow-500 dark:focus-visible:ring-yellow-500 text-white',
  blue:
    'bg-blue-600 hover:bg-blue-700 focus-visible:ring-blue-700 dark:bg-blue-600 dark:hover:bg-blue-500 dark:focus-visible:ring-blue-500 text-white',
  green:
    'bg-emerald-500 hover:bg-emerald-700 focus-visible:ring-emerald-700 dark:bg-emerald-500 dark:hover:bg-emerald-700 dark:focus-visible:ring-emerald-700 text-white',
  purple:
    'bg-purple-600 hover:bg-purple-700 focus-visible:ring-purple-700 dark:bg-purple-600 dark:hover:bg-purple-500 dark:focus-visible:ring-purple-500 text-white',
  brown:
    'bg-amber-600 hover:bg-amber-700 focus-visible:ring-amber-700 dark:bg-amber-600 dark:hover:bg-amber-500 dark:focus-visible:ring-amber-500 text-white',
  cyan:
    'bg-cyan-600 hover:bg-cyan-700 focus-visible:ring-cyan-700 dark:bg-cyan-600 dark:hover:bg-cyan-500 dark:focus-visible:ring-cyan-500 text-white',
  red:
    'bg-red-600 hover:bg-red-700 focus-visible:ring-red-700 dark:bg-red-600 dark:hover:bg-red-500 dark:focus-visible:ring-red-500 text-white',
  slate:
    'bg-slate-600 hover:bg-slate-700 focus-visible:ring-slate-700 dark:bg-slate-600 dark:hover:bg-slate-500 dark:focus-visible:ring-slate-500 text-white',
};

const box = boxColors[color] || boxColors.blue;
const btn = btnColors[buttonColor ?? color] || btnColors.blue;
---

<div
  class:list={[
    'w-full rounded-lg p-6 mb-8 border-r-4 shadow-sm flex flex-col gap-4 items-center text-center',
    box,
    'transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5',
  ]}
  style="direction: rtl;"
>
  <div class="div class="flex items-center gap-3 justify-center">
    {hasIcon && (
      <div class="w-9 h-9 flex-shrink-0 flex items-center justify-center rounded-full bg-white/80 dark:bg-black/30 backdrop-blur-sm">
        <i class:list={['fas', icon!, 'text-base']}></i>
      </div>
    )}

    <h3 class="m-0 text-xl font-extrabold leading-none">{title}</h3>
  </div>

  <div class="flex-1 prose dark:prose-invert max-w-none leading-relaxed">
    <slot />
  </div>

  <div class="mt-4">
    <a
      href={href}
      class:list={[
        'inline-flex items-center justify-center rounded-full px-5 py-3 text-base font-bold shadow focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 transition-colors duration-200',
        btn,
      ]}
    >
      {buttonText}
    </a>
  </div>
</div>
